create table if not exists cars
(
	id bigserial not null
		constraint cars_pk
			primary key,
	model varchar(20) not null,
	issue_country varchar(20) not null,
	guarantee_period integer not null,
	price numeric not null,
	created timestamp not null,
	changed timestamp not null,
	user_order_id bigint
);

alter table cars owner to paulus;

create unique index if not exists cars_id_uindex
	on cars (id);

create table if not exists bodies
(
	id bigserial not null
		constraint bodies_pk
			primary key,
	color varchar(20) not null,
	body_type varchar(20) not null,
	created timestamp not null,
	changed timestamp not null,
	car_id bigint
		constraint bodies_cars_id_fk
			references cars
				on update cascade on delete cascade
);

alter table bodies owner to paulus;

create unique index if not exists bodies_id_uindex
	on bodies (id);

create table if not exists engines
(
	id bigserial not null
		constraint engines_pk
			primary key,
	fuel_type varchar(15) not null,
	volume double precision,
	cylinders_count integer,
	created timestamp not null,
	changed timestamp not null,
	car_id bigint not null
		constraint engines_cars_id_fk
			references cars
				on update cascade on delete cascade
);

alter table engines owner to paulus;

create unique index if not exists engines_id_uindex
	on engines (id);

create table if not exists transmissions
(
	id serial not null
		constraint transmissions_pk
			primary key,
	transmission_type varchar(15) not null,
	gears_count integer not null,
	weight integer not null,
	created timestamp not null,
	changed timestamp not null,
	car_id bigint not null
		constraint transmissions_cars_id_fk
			references cars
				on update cascade on delete cascade
);

alter table transmissions owner to paulus;

create unique index if not exists transmissions_id_uindex
	on transmissions (id);

create table if not exists users
(
	id bigserial not null
		constraint users_pk
			primary key,
	firstname varchar(20) not null,
	lastname varchar(30) not null,
	birth_date date,
	login varchar(30) not null,
	password varchar(55) not null,
	email varchar(55) not null,
	role varchar(10) not null,
	is_blocked boolean default false not null,
	created timestamp not null,
	changed timestamp not null
);

alter table users owner to paulus;

create table if not exists user_orders
(
	id bigserial not null
		constraint user_orders_pk
			primary key,
	order_name varchar(30) not null,
	created timestamp not null,
	changed timestamp not null,
	user_id bigint not null
		constraint user_orders_users_id_fk
			references users
				on update cascade on delete cascade
);

alter table user_orders owner to paulus;

create unique index if not exists user_orders_id_uindex
	on user_orders (id);

create unique index if not exists users_id_uindex
	on users (id);

create unique index if not exists users_login_uindex
	on users (login);

create table if not exists dealers
(
	id bigserial not null
		constraint dealers_pk
			primary key,
	name varchar(20) not null,
	address varchar(55) not null,
	foundation_date date not null,
	city varchar(15) not null,
	created timestamp not null,
	changed timestamp not null,
	car_id bigint not null
		constraint dealers_cars_id_fk
			references cars
				on update cascade on delete cascade
);

alter table dealers owner to paulus;

create unique index if not exists dealers_id_uindex
	on dealers (id);

